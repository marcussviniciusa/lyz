(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[855],{3953:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>m});var r=s(7876),n=s(4232),t=s(9099),l=s(8230),o=s.n(l),i=s(4842),d=s(2471),c=s(1059),u=s(5454);let m=()=>{var e;let{user:a,loading:s}=(0,d.As)(),l=(0,t.useRouter)(),{id:m}=l.query,[p,x]=(0,n.useState)(null),[g,h]=(0,n.useState)({tongue:{color:"",coating:"",shape:"",moisture:"",notes:""},pulse:{rate:"",strength:"",rhythm:"",quality:"",notes:""},pattern_diagnosis:"",treatment_principles:"",additional_notes:""}),[b,f]=(0,n.useState)(!0),[y,v]=(0,n.useState)(!1),[j,N]=(0,n.useState)(null),[w,C]=(0,n.useState)(null);(0,n.useEffect)(()=>{a||s||l.push("/auth/login")},[a,s,l]),(0,n.useEffect)(()=>{let e=async()=>{if(m)try{f(!0);let e=(await c.a7.getPlanById(m)).data.plan||null;x(e),(null==e?void 0:e.tcm_observations)&&h(e.tcm_observations),N(null)}catch(e){N("Erro ao carregar detalhes do plano: "+(e.message||"Tente novamente mais tarde")),console.error("Error fetching plan details:",e)}finally{f(!1)}};a&&m&&e()},[a,m]),(0,n.useEffect)(()=>{p&&(p.questionnaire_data?p.lab_results||N("\xc9 necess\xe1rio enviar os resultados laboratoriais antes das observa\xe7\xf5es TCM"):N("\xc9 necess\xe1rio preencher o question\xe1rio antes das observa\xe7\xf5es TCM"))},[p]);let _=e=>{let{name:a,value:s}=e.target;if(a.includes(".")){let[e,r]=a.split(".");h(a=>({...a,[e]:{...a[e],[r]:s}}))}else h(e=>({...e,[a]:s}))},T=async e=>{if(e.preventDefault(),m)try{v(!0),C(null),N(null),console.log("Enviando dados de TCM para API:",{endpoint:"/plans/".concat(m,"/tcm"),data:g}),await c.a7.updateTCM(m,g),C("Observa\xe7\xf5es TCM salvas com sucesso!"),setTimeout(()=>{l.push("/plans/".concat(m,"/timeline"))},1500)}catch(l){var a,s,r,n;let e=(null===(s=l.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.message)||l.message||"Tente novamente mais tarde",t=(null===(r=l.response)||void 0===r?void 0:r.status)||"Desconhecido";N("Erro ao salvar observa\xe7\xf5es TCM (".concat(t,"): ").concat(e)),console.error("Error saving TCM observations:",{status:t,message:e,details:null===(n=l.response)||void 0===n?void 0:n.data,axiosError:l})}finally{v(!1)}};return s||b?(0,r.jsx)(i.A,{title:"Carregando Observa\xe7\xf5es TCM - Lyz",children:(0,r.jsx)("div",{className:"flex justify-center py-20",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"spinner-border h-10 w-10 text-primary-600 animate-spin"}),(0,r.jsx)("p",{className:"mt-4 text-lg text-gray-600",children:"Carregando dados..."})]})})}):a?!j||p&&p.questionnaire_data&&p.lab_results?(0,r.jsx)(i.A,{title:"Observa\xe7\xf5es TCM - Lyz",children:(0,r.jsxs)("div",{className:"max-w-5xl mx-auto px-4 py-10",children:[(0,r.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-primary","data-component-name":"TCMObservationsPage",children:"Observa\xe7\xf5es TCM"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Paciente: ",(null==p?void 0:null===(e=p.patient_data)||void 0===e?void 0:e.name)||""]})]}),(0,r.jsx)(o(),{href:"/plans/".concat(m),className:"btn-outline",children:"Voltar ao Plano"})]}),w&&(0,r.jsx)("div",{className:"mb-6 bg-green-50 p-4 rounded-md",children:(0,r.jsx)("p",{className:"text-green-700",children:w})}),j&&(null==p?void 0:p.questionnaire_data)&&(null==p?void 0:p.lab_results)&&(0,r.jsx)("div",{className:"mb-6 bg-red-50 p-4 rounded-md",children:(0,r.jsx)("p",{className:"text-red-700",children:j})}),(0,r.jsx)(u.A,{onFormDataChange:e=>h(e),currentData:g,formType:"tcm"}),(0,r.jsxs)("form",{onSubmit:T,className:"bg-white shadow-sm rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Observa\xe7\xe3o da L\xedngua"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cor"}),(0,r.jsx)("input",{type:"text",name:"tongue.color",value:g.tongue.color,onChange:_,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"P\xe1lida, vermelha, p\xfarpura, etc."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Saburra"}),(0,r.jsx)("input",{type:"text",name:"tongue.coating",value:g.tongue.coating,onChange:_,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Fina, grossa, branca, amarela, etc."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Forma"}),(0,r.jsx)("input",{type:"text",name:"tongue.shape",value:g.tongue.shape,onChange:_,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Inchada, fina, fissuras, etc."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Umidade"}),(0,r.jsx)("input",{type:"text",name:"tongue.moisture",value:g.tongue.moisture,onChange:_,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Seca, \xfamida, pegajosa, etc."})]})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observa\xe7\xf5es adicionais sobre a l\xedngua"}),(0,r.jsx)("textarea",{name:"tongue.notes",value:g.tongue.notes,onChange:_,rows:2,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Detalhes relevantes sobre marcas, \xe1reas espec\xedficas, etc."})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Observa\xe7\xe3o do Pulso"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Frequ\xeancia"}),(0,r.jsx)("input",{type:"text",name:"pulse.rate",value:g.pulse.rate,onChange:_,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Lento, r\xe1pido, normal, etc."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"For\xe7a"}),(0,r.jsx)("input",{type:"text",name:"pulse.strength",value:g.pulse.strength,onChange:_,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Forte, fraco, vazio, cheio, etc."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ritmo"}),(0,r.jsx)("input",{type:"text",name:"pulse.rhythm",value:g.pulse.rhythm,onChange:_,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Regular, irregular, etc."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Qualidade"}),(0,r.jsx)("input",{type:"text",name:"pulse.quality",value:g.pulse.quality,onChange:_,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Deslizante, em corda, firme, etc."})]})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observa\xe7\xf5es adicionais sobre o pulso"}),(0,r.jsx)("textarea",{name:"pulse.notes",value:g.pulse.notes,onChange:_,rows:2,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Posi\xe7\xf5es espec\xedficas, diferen\xe7as entre direita e esquerda, etc."})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Diagn\xf3stico de Padr\xf5es"}),(0,r.jsx)("textarea",{name:"pattern_diagnosis",value:g.pattern_diagnosis,onChange:_,rows:4,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Identifica\xe7\xe3o dos padr\xf5es de desarmonia segundo a Medicina Tradicional Chinesa"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Princ\xedpios de Tratamento"}),(0,r.jsx)("textarea",{name:"treatment_principles",value:g.treatment_principles,onChange:_,rows:4,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Princ\xedpios e estrat\xe9gias de tratamento baseados na MTC"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Observa\xe7\xf5es Adicionais"}),(0,r.jsx)("textarea",{name:"additional_notes",value:g.additional_notes,onChange:_,rows:4,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Quaisquer outras observa\xe7\xf5es relevantes para o diagn\xf3stico e tratamento"})]})]}),(0,r.jsxs)("div",{className:"mt-8 flex justify-end space-x-4",children:[(0,r.jsx)(o(),{href:"/plans/".concat(m),className:"btn-outline",children:"Cancelar"}),(0,r.jsx)("button",{type:"submit",disabled:y,className:"btn-primary",children:y?"Salvando...":"Salvar e Continuar"})]})]})]})}):(0,r.jsx)(i.A,{title:"Etapa Anterior Pendente - Lyz",children:(0,r.jsx)("div",{className:"max-w-3xl mx-auto px-4 py-10",children:(0,r.jsxs)("div",{className:"bg-yellow-50 p-6 rounded-lg",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-yellow-700 mb-2",children:"Etapa anterior pendente"}),(0,r.jsx)("p",{className:"text-yellow-600 mb-4",children:j}),(0,r.jsxs)("div",{className:"mt-4 flex space-x-4",children:[!(null==p?void 0:p.questionnaire_data)&&(0,r.jsx)(o(),{href:"/plans/".concat(m,"/questionnaire"),className:"btn-primary",children:"Ir para o Question\xe1rio"}),(null==p?void 0:p.questionnaire_data)&&!(null==p?void 0:p.lab_results)&&(0,r.jsx)(o(),{href:"/plans/".concat(m,"/lab"),className:"btn-primary",children:"Ir para Resultados Laboratoriais"}),(0,r.jsx)(o(),{href:"/plans/".concat(m),className:"btn-outline",children:"Voltar ao Plano"})]})]})})}):null}},7914:(e,a,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/plans/[id]/tcm",function(){return s(3953)}])}},e=>{var a=a=>e(e.s=a);e.O(0,[695,875,636,593,792],()=>a(7914)),_N_E=e.O()}]);