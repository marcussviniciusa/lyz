(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[864],{712:(e,a,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/plans/[id]/timeline",function(){return s(9134)}])},4842:(e,a,s)=>{"use strict";s.d(a,{A:()=>c});var t=s(7876);s(4232);var r=s(7328),n=s.n(r),l=s(2471),i=s(8230),o=s.n(i),d=s(9099);let c=e=>{let{children:a,title:s="Lyz - Planos C\xedclicos Personalizados"}=e,{user:r,logout:i,isAuthenticated:c,isSuperadmin:m}=(0,l.As)(),x=(0,d.useRouter)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n(),{children:[(0,t.jsx)("title",{children:s}),(0,t.jsx)("meta",{name:"description",content:"Sistema Lyz para planos personalizados baseados em ciclicidade feminina"}),(0,t.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,t.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,t.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,t.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between h-16",children:[(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0 flex items-center",children:(0,t.jsx)(o(),{href:"/",className:"text-2xl font-bold text-primary-600",children:"Lyz"})}),c&&(0,t.jsxs)("nav",{className:"ml-6 flex space-x-8",children:[(0,t.jsx)(o(),{href:"/dashboard",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat("/dashboard"===x.pathname?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Dashboard"}),(0,t.jsx)(o(),{href:"/plans",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat(x.pathname.startsWith("/plans")?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Meus Planos"}),m&&(0,t.jsx)(o(),{href:"/admin/dashboard",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat(x.pathname.startsWith("/admin")?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Administra\xe7\xe3o"})]})]}),(0,t.jsx)("div",{className:"flex items-center",children:c?(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-700",children:["Ol\xe1, ",null==r?void 0:r.name.split(" ")[0]]}),(0,t.jsx)("button",{onClick:i,className:"text-sm text-gray-700 hover:text-primary-600",children:"Sair"})]}):(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsx)(o(),{href:"/auth/login",className:"text-sm font-medium text-gray-700 hover:text-primary-600",children:"Entrar"}),(0,t.jsx)(o(),{href:"/auth/register",className:"text-sm font-medium bg-primary-600 text-white px-3 py-1 rounded-md hover:bg-primary-700",children:"Registrar"})]})})]})})}),(0,t.jsx)("main",{className:"flex-grow",children:a}),(0,t.jsx)("footer",{className:"bg-white border-t border-gray-200 py-4 mt-auto",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("p",{className:"text-center text-sm text-gray-500",children:["\xa9 ",new Date().getFullYear()," Lyz Healthcare. Todos os direitos reservados."]})})})]})]})}},9134:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>m});var t=s(7876),r=s(4232),n=s(9099),l=s(8230),i=s.n(l),o=s(4842),d=s(2471),c=s(1059);let m=()=>{var e;let{user:a,loading:s}=(0,d.As)(),l=(0,n.useRouter)(),{id:m}=l.query,[x,h]=(0,r.useState)(null),[u,p]=(0,r.useState)({events:[],developmental_factors:"",environmental_factors:"",nutritional_factors:"",psychosocial_factors:"",additional_notes:""}),[g,f]=(0,r.useState)({age:0,event:"",type:"health",description:""}),[y,v]=(0,r.useState)(!0),[b,j]=(0,r.useState)(!1),[N,w]=(0,r.useState)(null),[_,C]=(0,r.useState)(null);(0,r.useEffect)(()=>{a||s||l.push("/auth/login")},[a,s,l]),(0,r.useEffect)(()=>{let e=async()=>{if(m)try{v(!0);let e=(await c.a7.getPlanById(m)).data.plan||null;h(e),(null==e?void 0:e.timeline_data)&&p(e.timeline_data),w(null)}catch(e){w("Erro ao carregar detalhes do plano: "+(e.message||"Tente novamente mais tarde")),console.error("Error fetching plan details:",e)}finally{v(!1)}};a&&m&&e()},[a,m]),(0,r.useEffect)(()=>{x&&(x.questionnaire_data?x.lab_results?x.tcm_observations||w("\xc9 necess\xe1rio preencher as observa\xe7\xf5es TCM antes da timeline"):w("\xc9 necess\xe1rio enviar os resultados laboratoriais antes da timeline"):w("\xc9 necess\xe1rio preencher o question\xe1rio antes da timeline"))},[x]);let E=e=>{let{name:a,value:s}=e.target;p(e=>({...e,[a]:s}))},k=e=>{let{name:a,value:s}=e.target;f(e=>({...e,[a]:"age"===a?parseInt(s)||0:s}))},T=e=>{p(a=>({...a,events:a.events.filter((a,s)=>s!==e)}))},P=async e=>{if(e.preventDefault(),m)try{j(!0),C(null),w(null),await c.a7.updateTimeline(m,u),C("Timeline salva com sucesso!"),setTimeout(()=>{l.push("/plans/".concat(m,"/ifm"))},1500)}catch(e){w("Erro ao salvar timeline: "+(e.message||"Tente novamente mais tarde")),console.error("Error saving timeline:",e)}finally{j(!1)}};return s||y?(0,t.jsx)(o.A,{title:"Carregando Timeline - Lyz",children:(0,t.jsx)("div",{className:"flex justify-center py-20",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"spinner-border h-10 w-10 text-primary-600 animate-spin"}),(0,t.jsx)("p",{className:"mt-4 text-lg text-gray-600",children:"Carregando dados..."})]})})}):a?!N||x&&x.questionnaire_data&&x.lab_results&&x.tcm_observations?(0,t.jsx)(o.A,{title:"Timeline do Plano - Lyz",children:(0,t.jsxs)("div",{className:"max-w-5xl mx-auto px-4 py-10",children:[(0,t.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-primary","data-component-name":"TimelinePage",children:"Timeline"}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Paciente: ",(null==x?void 0:null===(e=x.patient_data)||void 0===e?void 0:e.name)||""]})]}),(0,t.jsx)(i(),{href:"/plans/".concat(m),className:"btn-outline",children:"Voltar ao Plano"})]}),_&&(0,t.jsx)("div",{className:"mb-6 bg-green-50 p-4 rounded-md",children:(0,t.jsx)("p",{className:"text-green-700",children:_})}),N&&(null==x?void 0:x.questionnaire_data)&&(null==x?void 0:x.lab_results)&&(null==x?void 0:x.tcm_observations)&&(0,t.jsx)("div",{className:"mb-6 bg-red-50 p-4 rounded-md",children:(0,t.jsx)("p",{className:"text-red-700",children:N})}),(0,t.jsxs)("form",{onSubmit:P,className:"bg-white shadow-sm rounded-lg p-6",children:[(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Eventos da Linha do Tempo"}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end bg-gray-50 p-4 rounded-md",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Idade"}),(0,t.jsx)("input",{type:"number",name:"age",value:g.age,onChange:k,min:"0",max:"120",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Idade"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),(0,t.jsxs)("select",{name:"type",value:g.type,onChange:k,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,t.jsx)("option",{value:"health",children:"Sa\xfade"}),(0,t.jsx)("option",{value:"life",children:"Vida"}),(0,t.jsx)("option",{value:"other",children:"Outro"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Evento"}),(0,t.jsx)("input",{type:"text",name:"event",value:g.event,onChange:k,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Nome do evento"})]}),(0,t.jsx)("div",{className:"flex items-end",children:(0,t.jsx)("button",{type:"button",onClick:()=>{if(!g.event||g.age<0){w("Preencha o evento e idade corretamente");return}p(e=>({...e,events:[...e.events,{...g}]})),f({age:0,event:"",type:"health",description:""}),w(null)},className:"btn-primary w-full",children:"Adicionar Evento"})})]}),(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o"}),(0,t.jsx)("textarea",{name:"description",value:g.description,onChange:k,rows:2,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Descri\xe7\xe3o detalhada do evento"})]})]}),u.events.length>0?(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Idade"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Evento"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descri\xe7\xe3o"}),(0,t.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"A\xe7\xf5es"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:u.events.map((e,a)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.age}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"health"===e.type?"Sa\xfade":"life"===e.type?"Vida":"Outro"}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.event}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:e.description}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,t.jsx)("button",{type:"button",onClick:()=>T(a),className:"text-red-600 hover:text-red-900",children:"Remover"})})]},a))})]})}):(0,t.jsx)("div",{className:"text-center py-6 bg-gray-50 rounded-md",children:(0,t.jsx)("p",{className:"text-gray-500",children:"Nenhum evento adicionado ainda"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Fatores Desenvolvimentais"}),(0,t.jsx)("textarea",{name:"developmental_factors",value:u.developmental_factors,onChange:E,rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Fatores relacionados ao desenvolvimento desde a inf\xe2ncia"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Fatores Ambientais"}),(0,t.jsx)("textarea",{name:"environmental_factors",value:u.environmental_factors,onChange:E,rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Exposi\xe7\xf5es ambientais, moradia, trabalho, etc."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Fatores Nutricionais"}),(0,t.jsx)("textarea",{name:"nutritional_factors",value:u.nutritional_factors,onChange:E,rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Mudan\xe7as na dieta ao longo do tempo, padr\xf5es alimentares, etc."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Fatores Psicossociais"}),(0,t.jsx)("textarea",{name:"psychosocial_factors",value:u.psychosocial_factors,onChange:E,rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Eventos de vida estressantes, traumas, relacionamentos, etc."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Observa\xe7\xf5es Adicionais"}),(0,t.jsx)("textarea",{name:"additional_notes",value:u.additional_notes,onChange:E,rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Quaisquer outras observa\xe7\xf5es relevantes para a timeline do paciente"})]})]}),(0,t.jsxs)("div",{className:"mt-8 flex justify-end space-x-4",children:[(0,t.jsx)(i(),{href:"/plans/".concat(m),className:"btn-outline",children:"Cancelar"}),(0,t.jsx)("button",{type:"submit",disabled:b,className:"btn-primary",children:b?"Salvando...":"Salvar e Continuar"})]})]})]})}):(0,t.jsx)(o.A,{title:"Etapa Anterior Pendente - Lyz",children:(0,t.jsx)("div",{className:"max-w-3xl mx-auto px-4 py-10",children:(0,t.jsxs)("div",{className:"bg-yellow-50 p-6 rounded-lg",children:[(0,t.jsx)("h2",{className:"text-lg font-medium text-yellow-700 mb-2",children:"Etapa anterior pendente"}),(0,t.jsx)("p",{className:"text-yellow-600 mb-4",children:N}),(0,t.jsxs)("div",{className:"mt-4 flex space-x-4",children:[!(null==x?void 0:x.questionnaire_data)&&(0,t.jsx)(i(),{href:"/plans/".concat(m,"/questionnaire"),className:"btn-primary",children:"Ir para o Question\xe1rio"}),(null==x?void 0:x.questionnaire_data)&&!(null==x?void 0:x.lab_results)&&(0,t.jsx)(i(),{href:"/plans/".concat(m,"/lab"),className:"btn-primary",children:"Ir para Resultados Laboratoriais"}),(null==x?void 0:x.questionnaire_data)&&(null==x?void 0:x.lab_results)&&!(null==x?void 0:x.tcm_observations)&&(0,t.jsx)(i(),{href:"/plans/".concat(m,"/tcm"),className:"btn-primary",children:"Ir para Observa\xe7\xf5es TCM"}),(0,t.jsx)(i(),{href:"/plans/".concat(m),className:"btn-outline",children:"Voltar ao Plano"})]})]})})}):null}}},e=>{var a=a=>e(e.s=a);e.O(0,[695,636,593,792],()=>a(712)),_N_E=e.O()}]);