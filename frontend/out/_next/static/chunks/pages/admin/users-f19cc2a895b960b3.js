(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[840],{406:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>m});var a=s(7876),t=s(4232),i=s(4842),l=s(2471),n=s(9099),d=s(1059),o=s(8230),c=s.n(o);let m=()=>{let{user:e,isAuthenticated:r,isSuperadmin:s,loading:o}=(0,l.As)(),m=(0,n.useRouter)(),[x,h]=(0,t.useState)([]),[p,u]=(0,t.useState)([]),[y,g]=(0,t.useState)(!0),[f,j]=(0,t.useState)(null),[b,N]=(0,t.useState)(!1),[v,w]=(0,t.useState)({name:"",email:"",password:"",role:"user",company_id:""}),[E,k]=(0,t.useState)(!1),[S,_]=(0,t.useState)(null),[C,A]=(0,t.useState)(!1),[U,z]=(0,t.useState)(null),[F,T]=(0,t.useState)("");(0,t.useEffect)(()=>{o||r&&s||m.push("/auth/login")},[r,s,o,m]);let L=async()=>{try{let e=await d.Er.getCompanies();u(e.data.companies||[])}catch(e){console.error("Error fetching companies:",e)}},P=async()=>{try{g(!0),j(null);let e=await d.Er.getUsers(F);h(e.data.users||[])}catch(e){console.error("Error fetching users:",e),j("Erro ao carregar usu\xe1rios: "+(e.message||"Tente novamente"))}finally{g(!1)}};(0,t.useEffect)(()=>{r&&s&&(L(),P())},[r,s]),(0,t.useEffect)(()=>{r&&s&&P()},[F]);let q=e=>{let{name:r,value:s}=e.target;w(e=>({...e,[r]:s}))},D=async e=>{e.preventDefault(),A(!0),z(null);try{if(E&&S){let{password:e,...r}=v,s={...r,...e?{password:e}:{}};await d.Er.updateUser(S,s)}else{if(!v.password){z("A senha \xe9 obrigat\xf3ria para novos usu\xe1rios"),A(!1);return}await d.Er.createUser(v)}P(),R()}catch(e){console.error("Form submission error:",e),z("Erro ao salvar usu\xe1rio: "+(e.message||"Tente novamente"))}finally{A(!1)}},R=()=>{w({name:"",email:"",password:"",role:"user",company_id:""}),N(!1),k(!1),_(null)},O=e=>{w({name:e.name,email:e.email,password:"",role:e.role,company_id:e.company_id.toString()}),k(!0),_(e.id),N(!0)},G=async e=>{if(window.confirm("Tem certeza que deseja excluir este usu\xe1rio?"))try{await d.Er.deleteUser(e),P()}catch(e){console.error("Error deleting user:",e),alert("Erro ao excluir usu\xe1rio: "+(e.message||"Tente novamente"))}},W=e=>{if(null==e||!Array.isArray(p))return"N/A";let r=e.toString(),s=p.find(e=>e&&e.id&&e.id.toString()===r);return s&&s.name?s.name:"N/A"};return!o&&r&&s?(0,a.jsx)(i.A,{title:"Gerenciar Usu\xe1rios - Lyz",children:(0,a.jsx)("div",{className:"bg-gray-50 min-h-[calc(100vh-136px)] py-10",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Gerenciamento de Usu\xe1rios"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"Administre os usu\xe1rios do sistema Lyz"})]}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{onClick:()=>N(!b),className:"bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg",children:b?"Cancelar":"Novo Usu\xe1rio"})})]}),b&&(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6 mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:E?"Editar Usu\xe1rio":"Novo Usu\xe1rio"}),U&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:U}),(0,a.jsxs)("form",{onSubmit:D,children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Completo *"}),(0,a.jsx)("input",{type:"text",id:"name",name:"name",value:v.name,onChange:q,className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),(0,a.jsx)("input",{type:"email",id:"email",name:"email",value:v.email,onChange:q,className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:E?"Senha (deixe vazio para manter a atual)":"Senha *"}),(0,a.jsx)("input",{type:"password",id:"password",name:"password",value:v.password,onChange:q,className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-primary-500",required:!E})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:"Perfil *"}),(0,a.jsxs)("select",{id:"role",name:"role",value:v.role,onChange:q,className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0,children:[(0,a.jsx)("option",{value:"user",children:"Usu\xe1rio"}),(0,a.jsx)("option",{value:"superadmin",children:"Administrador"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"company_id",className:"block text-sm font-medium text-gray-700 mb-1",children:"Empresa *"}),(0,a.jsxs)("select",{id:"company_id",name:"company_id",value:v.company_id,onChange:q,className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0,children:[(0,a.jsx)("option",{value:"",children:"Selecione uma empresa"}),p.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end mt-6",children:[(0,a.jsx)("button",{type:"button",onClick:R,className:"mr-2 bg-white border border-gray-300 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-50",children:"Cancelar"}),(0,a.jsx)("button",{type:"submit",className:"bg-primary-600 hover:bg-primary-700 text-white py-2 px-4 rounded-md",disabled:C,children:C?"Salvando...":E?"Atualizar":"Salvar"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6 mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Filtros"}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsxs)("div",{className:"w-1/3",children:[(0,a.jsx)("label",{htmlFor:"company-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Empresa"}),(0,a.jsxs)("select",{id:"company-filter",value:F,onChange:e=>T(e.target.value),className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"",children:"Todas as empresas"}),p.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]})})]}),(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Usu\xe1rios"})}),y?(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Carregando usu\xe1rios..."})}):f?(0,a.jsxs)("div",{className:"text-center py-8 text-red-500",children:[(0,a.jsx)("p",{children:f}),(0,a.jsx)("button",{className:"mt-2 text-primary-600 hover:underline",onClick:P,children:"Tentar novamente"})]}):0===x.length?(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Nenhum usu\xe1rio encontrado."})}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Perfil"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Empresa"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"\xdaltimo Login"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"A\xe7\xf5es"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.email})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat("superadmin"===e.role?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"),children:"superadmin"===e.role?"Admin":"Usu\xe1rio"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-500",children:W(e.company_id)})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.last_login?new Date(e.last_login).toLocaleString("pt-BR"):"Nunca"})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,a.jsx)("button",{onClick:()=>O(e),className:"text-primary-600 hover:text-primary-900 mr-4",children:"Editar"}),(0,a.jsx)("button",{onClick:()=>G(e.id),className:"text-red-600 hover:text-red-900",children:"Excluir"})]})]},e.id))})]})})]}),(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsx)(c(),{href:"/admin/dashboard",className:"text-primary-600 hover:text-primary-800 font-medium",children:"â† Voltar ao Dashboard"})})]})})}):(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:"Carregando..."})}},3432:(e,r,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/users",function(){return s(406)}])},4842:(e,r,s)=>{"use strict";s.d(r,{A:()=>c});var a=s(7876);s(4232);var t=s(7328),i=s.n(t),l=s(2471),n=s(8230),d=s.n(n),o=s(9099);let c=e=>{let{children:r,title:s="Lyz - Planos C\xedclicos Personalizados"}=e,{user:t,logout:n,isAuthenticated:c,isSuperadmin:m}=(0,l.As)(),x=(0,o.useRouter)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i(),{children:[(0,a.jsx)("title",{children:s}),(0,a.jsx)("meta",{name:"description",content:"Sistema Lyz para planos personalizados baseados em ciclicidade feminina"}),(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,a.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,a.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0 flex items-center",children:(0,a.jsx)(d(),{href:"/",className:"text-2xl font-bold text-primary-600",children:"Lyz"})}),c&&(0,a.jsxs)("nav",{className:"ml-6 flex space-x-8",children:[(0,a.jsx)(d(),{href:"/dashboard",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat("/dashboard"===x.pathname?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Dashboard"}),(0,a.jsx)(d(),{href:"/plans",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat(x.pathname.startsWith("/plans")?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Meus Planos"}),m&&(0,a.jsx)(d(),{href:"/admin/dashboard",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat(x.pathname.startsWith("/admin")?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Administra\xe7\xe3o"})]})]}),(0,a.jsx)("div",{className:"flex items-center",children:c?(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:["Ol\xe1, ",null==t?void 0:t.name.split(" ")[0]]}),(0,a.jsx)("button",{onClick:n,className:"text-sm text-gray-700 hover:text-primary-600",children:"Sair"})]}):(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsx)(d(),{href:"/auth/login",className:"text-sm font-medium text-gray-700 hover:text-primary-600",children:"Entrar"}),(0,a.jsx)(d(),{href:"/auth/register",className:"text-sm font-medium bg-primary-600 text-white px-3 py-1 rounded-md hover:bg-primary-700",children:"Registrar"})]})})]})})}),(0,a.jsx)("main",{className:"flex-grow",children:r}),(0,a.jsx)("footer",{className:"bg-white border-t border-gray-200 py-4 mt-auto",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("p",{className:"text-center text-sm text-gray-500",children:["\xa9 ",new Date().getFullYear()," Lyz Healthcare. Todos os direitos reservados."]})})})]})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[695,636,593,792],()=>r(3432)),_N_E=e.O()}]);