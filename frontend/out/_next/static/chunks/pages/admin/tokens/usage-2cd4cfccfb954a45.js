(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[370],{3184:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/tokens/usage",function(){return t(5100)}])},4842:(e,s,t)=>{"use strict";t.d(s,{A:()=>o});var a=t(7876);t(4232);var r=t(7328),i=t.n(r),l=t(2471),n=t(8230),d=t.n(n),c=t(9099);let o=e=>{let{children:s,title:t="Lyz - Planos C\xedclicos Personalizados"}=e,{user:r,logout:n,isAuthenticated:o,isSuperadmin:x}=(0,l.As)(),m=(0,c.useRouter)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i(),{children:[(0,a.jsx)("title",{children:t}),(0,a.jsx)("meta",{name:"description",content:"Sistema Lyz para planos personalizados baseados em ciclicidade feminina"}),(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,a.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,a.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0 flex items-center",children:(0,a.jsx)(d(),{href:"/",className:"text-2xl font-bold text-primary-600",children:"Lyz"})}),o&&(0,a.jsxs)("nav",{className:"ml-6 flex space-x-8",children:[(0,a.jsx)(d(),{href:"/dashboard",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat("/dashboard"===m.pathname?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Dashboard"}),(0,a.jsx)(d(),{href:"/plans",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat(m.pathname.startsWith("/plans")?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Meus Planos"}),x&&(0,a.jsx)(d(),{href:"/admin/dashboard",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat(m.pathname.startsWith("/admin")?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Administra\xe7\xe3o"})]})]}),(0,a.jsx)("div",{className:"flex items-center",children:o?(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:["Ol\xe1, ",null==r?void 0:r.name.split(" ")[0]]}),(0,a.jsx)("button",{onClick:n,className:"text-sm text-gray-700 hover:text-primary-600",children:"Sair"})]}):(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsx)(d(),{href:"/auth/login",className:"text-sm font-medium text-gray-700 hover:text-primary-600",children:"Entrar"}),(0,a.jsx)(d(),{href:"/auth/register",className:"text-sm font-medium bg-primary-600 text-white px-3 py-1 rounded-md hover:bg-primary-700",children:"Registrar"})]})})]})})}),(0,a.jsx)("main",{className:"flex-grow",children:s}),(0,a.jsx)("footer",{className:"bg-white border-t border-gray-200 py-4 mt-auto",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("p",{className:"text-center text-sm text-gray-500",children:["\xa9 ",new Date().getFullYear()," Lyz Healthcare. Todos os direitos reservados."]})})})]})]})}},5100:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>x});var a=t(7876),r=t(4232),i=t(4842),l=t(2471),n=t(9099),d=t(1059),c=t(8230),o=t.n(c);let x=()=>{let{user:e,isAuthenticated:s,isSuperadmin:t,loading:c}=(0,l.As)(),x=(0,n.useRouter)(),[m,h]=(0,r.useState)([]),[p,u]=(0,r.useState)([]),[g,y]=(0,r.useState)(!0),[j,f]=(0,r.useState)(null),[N,b]=(0,r.useState)(""),[v,w]=(0,r.useState)(""),[k,_]=(0,r.useState)(""),[E,C]=(0,r.useState)(0);(0,r.useEffect)(()=>{c||s&&t||x.push("/auth/login")},[s,t,c,x]);let S=async()=>{try{let e=await d.Er.getCompanies();u(e.data.companies||[])}catch(e){console.error("Error fetching companies:",e)}},T=async()=>{try{y(!0),f(null);let e={};N&&(e.company_id=N),v&&(e.from=v),k&&(e.to=k);let s=await d.Er.getTokenUsage(e);h(s.data.usage||[]);let t=(s.data.usage||[]).reduce((e,s)=>e+s.token_count,0);C(t)}catch(e){console.error("Error fetching token usage:",e),f("Erro ao carregar dados de uso de tokens: "+(e.message||"Tente novamente"))}finally{y(!1)}};(0,r.useEffect)(()=>{s&&t&&(S(),T())},[s,t]);let L=e=>new Date(e).toLocaleString("pt-BR");return!c&&s&&t?(0,a.jsx)(i.A,{title:"Uso de Tokens - Lyz",children:(0,a.jsx)("div",{className:"bg-gray-50 min-h-[calc(100vh-136px)] py-10",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsx)("div",{className:"flex justify-between items-center mb-8",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Relat\xf3rio de Uso de Tokens"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"Acompanhe o uso de tokens das empresas e usu\xe1rios"})]})}),(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6 mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Filtros"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"company-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Empresa"}),(0,a.jsxs)("select",{id:"company-filter",value:N,onChange:e=>b(e.target.value),className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"",children:"Todas as empresas"}),p.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"date-from",className:"block text-sm font-medium text-gray-700 mb-1",children:"Data inicial"}),(0,a.jsx)("input",{type:"date",id:"date-from",value:v,onChange:e=>w(e.target.value),className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"date-to",className:"block text-sm font-medium text-gray-700 mb-1",children:"Data final"}),(0,a.jsx)("input",{type:"date",id:"date-to",value:k,onChange:e=>_(e.target.value),className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{onClick:()=>{b(""),w(""),_(""),setTimeout(()=>{T()},0)},className:"bg-white border border-gray-300 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-50",children:"Limpar Filtros"}),(0,a.jsx)("button",{onClick:()=>{T()},className:"bg-primary-600 hover:bg-primary-700 text-white py-2 px-4 rounded-md",children:"Aplicar Filtros"})]})]}),(0,a.jsx)("div",{className:"bg-white shadow-md rounded-lg p-6 mb-6",children:(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total de Tokens Usados"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-primary-700",children:E.toLocaleString()})]})})}),(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Hist\xf3rico de Uso"})}),g?(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Carregando dados de uso..."})}):j?(0,a.jsxs)("div",{className:"text-center py-8 text-red-500",children:[(0,a.jsx)("p",{children:j}),(0,a.jsx)("button",{className:"mt-2 text-primary-600 hover:underline",onClick:T,children:"Tentar novamente"})]}):0===m.length?(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Nenhum registro de uso encontrado com os filtros atuais."})}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data/Hora"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Empresa"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usu\xe1rio"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Prompt"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tokens"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-900",children:L(e.created_at)})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-900",children:e.company_name})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-900",children:e.user_email})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-900",children:e.prompt_name})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.token_count.toLocaleString()})})]},e.id))})]})})]}),(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsx)(o(),{href:"/admin/dashboard",className:"text-primary-600 hover:text-primary-800 font-medium",children:"â† Voltar ao Dashboard"})})]})})}):(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:"Carregando..."})}}},e=>{var s=s=>e(e.s=s);e.O(0,[695,636,593,792],()=>s(3184)),_N_E=e.O()}]);