(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[893],{4842:(e,a,r)=>{"use strict";r.d(a,{A:()=>c});var t=r(7876);r(4232);var s=r(7328),i=r.n(s),n=r(2471),l=r(8230),d=r.n(l),m=r(9099);let c=e=>{let{children:a,title:r="Lyz - Planos C\xedclicos Personalizados"}=e,{user:s,logout:l,isAuthenticated:c,isSuperadmin:o}=(0,n.As)(),x=(0,m.useRouter)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i(),{children:[(0,t.jsx)("title",{children:r}),(0,t.jsx)("meta",{name:"description",content:"Sistema Lyz para planos personalizados baseados em ciclicidade feminina"}),(0,t.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,t.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,t.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,t.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between h-16",children:[(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0 flex items-center",children:(0,t.jsx)(d(),{href:"/",className:"text-2xl font-bold text-primary-600",children:"Lyz"})}),c&&(0,t.jsxs)("nav",{className:"ml-6 flex space-x-8",children:[(0,t.jsx)(d(),{href:"/dashboard",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat("/dashboard"===x.pathname?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Dashboard"}),(0,t.jsx)(d(),{href:"/plans",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat(x.pathname.startsWith("/plans")?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Meus Planos"}),o&&(0,t.jsx)(d(),{href:"/admin/dashboard",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat(x.pathname.startsWith("/admin")?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Administra\xe7\xe3o"})]})]}),(0,t.jsx)("div",{className:"flex items-center",children:c?(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-700",children:["Ol\xe1, ",null==s?void 0:s.name.split(" ")[0]]}),(0,t.jsx)("button",{onClick:l,className:"text-sm text-gray-700 hover:text-primary-600",children:"Sair"})]}):(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsx)(d(),{href:"/auth/login",className:"text-sm font-medium text-gray-700 hover:text-primary-600",children:"Entrar"}),(0,t.jsx)(d(),{href:"/auth/register",className:"text-sm font-medium bg-primary-600 text-white px-3 py-1 rounded-md hover:bg-primary-700",children:"Registrar"})]})})]})})}),(0,t.jsx)("main",{className:"flex-grow",children:a}),(0,t.jsx)("footer",{className:"bg-white border-t border-gray-200 py-4 mt-auto",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("p",{className:"text-center text-sm text-gray-500",children:["\xa9 ",new Date().getFullYear()," Lyz Healthcare. Todos os direitos reservados."]})})})]})]})}},6235:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>o});var t=r(7876),s=r(4232),i=r(4842),n=r(2471),l=r(9099),d=r(1059),m=r(8230),c=r.n(m);let o=()=>{let{user:e,isAuthenticated:a,isSuperadmin:r,loading:m}=(0,n.As)(),o=(0,l.useRouter)(),[x,h]=(0,s.useState)([]),[p,u]=(0,s.useState)(!0),[y,g]=(0,s.useState)(null),[j,b]=(0,s.useState)(!1),[f,N]=(0,s.useState)({name:"",token_limit:1e4}),[v,w]=(0,s.useState)(!1),[k,E]=(0,s.useState)(null),[_,C]=(0,s.useState)(!1),[S,z]=(0,s.useState)(null);(0,s.useEffect)(()=>{m||a&&r||o.push("/auth/login")},[a,r,m,o]);let L=async()=>{try{u(!0),g(null);let e=await d.Er.getCompanies();h(e.data.companies||[])}catch(e){console.error("Error fetching companies:",e),g("Erro ao carregar empresas: "+(e.message||"Tente novamente"))}finally{u(!1)}};(0,s.useEffect)(()=>{a&&r&&L()},[a,r]);let T=e=>{let{name:a,value:r}=e.target;N(e=>({...e,[a]:"token_limit"===a?parseInt(r)||0:r}))},A=async e=>{e.preventDefault(),C(!0),z(null);try{v&&k?await d.Er.updateCompany(k,f):await d.Er.createCompany(f),L(),D()}catch(e){console.error("Form submission error:",e),z("Erro ao salvar empresa: "+(e.message||"Tente novamente"))}finally{C(!1)}},D=()=>{N({name:"",token_limit:1e4}),b(!1),w(!1),E(null)},F=e=>{N({name:e.name,token_limit:e.token_limit}),w(!0),E(e.id),b(!0)},P=async e=>{if(window.confirm("Tem certeza que deseja excluir esta empresa?"))try{await d.Er.deleteCompany(e),L()}catch(e){console.error("Error deleting company:",e),alert("Erro ao excluir empresa: "+(e.message||"Tente novamente"))}};return!m&&a&&r?(0,t.jsx)(i.A,{title:"Gerenciar Empresas - Lyz",children:(0,t.jsx)("div",{className:"bg-gray-50 min-h-[calc(100vh-136px)] py-10",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Gerenciamento de Empresas"}),(0,t.jsx)("p",{className:"mt-2 text-gray-600",children:"Adicione, edite ou remova empresas do sistema Lyz"})]}),(0,t.jsx)("div",{children:(0,t.jsx)("button",{onClick:()=>b(!j),className:"bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg",children:j?"Cancelar":"Nova Empresa"})})]}),j&&(0,t.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6 mb-8",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:v?"Editar Empresa":"Nova Empresa"}),S&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:S}),(0,t.jsxs)("form",{onSubmit:A,children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Empresa *"}),(0,t.jsx)("input",{type:"text",id:"name",name:"name",value:f.name,onChange:T,className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"token_limit",className:"block text-sm font-medium text-gray-700 mb-1",children:"Limite de Tokens"}),(0,t.jsx)("input",{type:"number",id:"token_limit",name:"token_limit",value:f.token_limit,onChange:T,className:"w-full border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-primary-500",min:"1000"})]})]}),(0,t.jsxs)("div",{className:"flex justify-end mt-6",children:[(0,t.jsx)("button",{type:"button",onClick:D,className:"mr-2 bg-white border border-gray-300 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-50",children:"Cancelar"}),(0,t.jsx)("button",{type:"submit",className:"bg-primary-600 hover:bg-primary-700 text-white py-2 px-4 rounded-md",disabled:_,children:_?"Salvando...":v?"Atualizar":"Salvar"})]})]})]}),(0,t.jsxs)("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Empresas"})}),p?(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)("p",{className:"text-gray-500",children:"Carregando empresas..."})}):y?(0,t.jsxs)("div",{className:"text-center py-8 text-red-500",children:[(0,t.jsx)("p",{children:y}),(0,t.jsx)("button",{className:"mt-2 text-primary-600 hover:underline",onClick:L,children:"Tentar novamente"})]}):0===x.length?(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)("p",{className:"text-gray-500",children:"Nenhuma empresa encontrada."})}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome"}),(0,t.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Limite de Tokens"}),(0,t.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data de Cria\xe7\xe3o"}),(0,t.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"A\xe7\xf5es"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"text-sm text-gray-500",children:e.token_limit.toLocaleString()})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString("pt-BR")})}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,t.jsx)("button",{onClick:()=>F(e),className:"text-primary-600 hover:text-primary-900 mr-4",children:"Editar"}),(0,t.jsx)("button",{onClick:()=>P(e.id),className:"text-red-600 hover:text-red-900",children:"Excluir"})]})]},e.id))})]})})]}),(0,t.jsx)("div",{className:"mt-8",children:(0,t.jsx)(c(),{href:"/admin/dashboard",className:"text-primary-600 hover:text-primary-800 font-medium",children:"â† Voltar ao Dashboard"})})]})})}):(0,t.jsx)("div",{className:"flex justify-center items-center h-screen",children:"Carregando..."})}},8776:(e,a,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/companies",function(){return r(6235)}])}},e=>{var a=a=>e(e.s=a);e.O(0,[695,636,593,792],()=>a(8776)),_N_E=e.O()}]);