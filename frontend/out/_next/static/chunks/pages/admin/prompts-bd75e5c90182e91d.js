(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[549],{4316:(e,r,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/prompts",function(){return a(5355)}])},4842:(e,r,a)=>{"use strict";a.d(r,{A:()=>c});var t=a(7876);a(4232);var s=a(7328),l=a.n(s),n=a(2471),i=a(8230),d=a.n(i),o=a(9099);let c=e=>{let{children:r,title:a="Lyz - Planos C\xedclicos Personalizados"}=e,{user:s,logout:i,isAuthenticated:c,isSuperadmin:m}=(0,n.As)(),x=(0,o.useRouter)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(l(),{children:[(0,t.jsx)("title",{children:a}),(0,t.jsx)("meta",{name:"description",content:"Sistema Lyz para planos personalizados baseados em ciclicidade feminina"}),(0,t.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,t.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,t.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,t.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between h-16",children:[(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0 flex items-center",children:(0,t.jsx)(d(),{href:"/",className:"text-2xl font-bold text-primary-600",children:"Lyz"})}),c&&(0,t.jsxs)("nav",{className:"ml-6 flex space-x-8",children:[(0,t.jsx)(d(),{href:"/dashboard",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat("/dashboard"===x.pathname?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Dashboard"}),(0,t.jsx)(d(),{href:"/plans",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat(x.pathname.startsWith("/plans")?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Meus Planos"}),m&&(0,t.jsx)(d(),{href:"/admin/dashboard",className:"inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium ".concat(x.pathname.startsWith("/admin")?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:"Administra\xe7\xe3o"})]})]}),(0,t.jsx)("div",{className:"flex items-center",children:c?(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-700",children:["Ol\xe1, ",null==s?void 0:s.name.split(" ")[0]]}),(0,t.jsx)("button",{onClick:i,className:"text-sm text-gray-700 hover:text-primary-600",children:"Sair"})]}):(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsx)(d(),{href:"/auth/login",className:"text-sm font-medium text-gray-700 hover:text-primary-600",children:"Entrar"}),(0,t.jsx)(d(),{href:"/auth/register",className:"text-sm font-medium bg-primary-600 text-white px-3 py-1 rounded-md hover:bg-primary-700",children:"Registrar"})]})})]})})}),(0,t.jsx)("main",{className:"flex-grow",children:r}),(0,t.jsx)("footer",{className:"bg-white border-t border-gray-200 py-4 mt-auto",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("p",{className:"text-center text-sm text-gray-500",children:["\xa9 ",new Date().getFullYear()," Lyz Healthcare. Todos os direitos reservados."]})})})]})]})}},5355:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>m});var t=a(7876),s=a(4232),l=a(4842),n=a(2471),i=a(9099),d=a(1059),o=a(8230),c=a.n(o);let m=()=>{let{user:e,isAuthenticated:r,isSuperadmin:a,loading:o}=(0,n.As)(),m=(0,i.useRouter)(),[x,p]=(0,s.useState)([]),[h,g]=(0,s.useState)(null),[u,y]=(0,s.useState)(!0),[v,j]=(0,s.useState)(null),[b,f]=(0,s.useState)(""),[N,w]=(0,s.useState)(!1),[E,S]=(0,s.useState)(!1),[_,k]=(0,s.useState)(null);(0,s.useEffect)(()=>{o||r&&a||m.push("/auth/login")},[r,a,o,m]);let P=async()=>{try{y(!0),j(null);let e=await d.Er.getPrompts();p(e.data.prompts||[])}catch(e){console.error("Error fetching prompts:",e),j("Erro ao carregar prompts: "+(e.message||"Tente novamente"))}finally{y(!1)}};(0,s.useEffect)(()=>{r&&a&&P()},[r,a]);let C=async e=>{try{y(!0);let r=(await d.Er.getPromptById(e)).data.prompt;g(r),f(r.content),S(!1),k(null)}catch(e){console.error("Error loading prompt:",e),alert("Erro ao carregar prompt: "+(e.message||"Tente novamente"))}finally{y(!1)}},z=async()=>{if(h)try{w(!0),S(!1),k(null),await d.Er.updatePrompt(h.id,{content:b}),p(x.map(e=>e.id===h.id?{...e,content:b,updated_at:new Date().toISOString()}:e)),g({...h,content:b,updated_at:new Date().toISOString()}),S(!0),setTimeout(()=>{S(!1)},3e3)}catch(e){console.error("Error saving prompt:",e),k("Erro ao salvar prompt: "+(e.message||"Tente novamente"))}finally{w(!1)}};return!o&&r&&a?(0,t.jsx)(l.A,{title:"Gerenciar Prompts - Lyz",children:(0,t.jsx)("div",{className:"bg-gray-50 min-h-[calc(100vh-136px)] py-10",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Gerenciamento de Prompts"}),(0,t.jsx)("p",{className:"mt-2 text-gray-600",children:"Edite os prompts utilizados pelo sistema Lyz para intera\xe7\xe3o com IA"})]}),(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[(0,t.jsx)("div",{className:"w-full lg:w-1/3",children:(0,t.jsxs)("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Prompts Dispon\xedveis"})}),u&&!h?(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)("p",{className:"text-gray-500",children:"Carregando prompts..."})}):v?(0,t.jsxs)("div",{className:"text-center py-8 text-red-500",children:[(0,t.jsx)("p",{children:v}),(0,t.jsx)("button",{className:"mt-2 text-primary-600 hover:underline",onClick:P,children:"Tentar novamente"})]}):0===x.length?(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)("p",{className:"text-gray-500",children:"Nenhum prompt encontrado."})}):(0,t.jsx)("div",{className:"divide-y divide-gray-200",children:x.map(e=>(0,t.jsxs)("button",{onClick:()=>C(e.id),className:"w-full text-left px-6 py-4 hover:bg-gray-50 transition-colors ".concat((null==h?void 0:h.id)===e.id?"bg-blue-50":""),children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:e.step_key}),(0,t.jsx)("p",{className:"text-sm text-gray-500 truncate",children:e.step_key}),(0,t.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Atualizado em: ",new Date(e.updated_at).toLocaleString("pt-BR")]})]},e.id))})]})}),(0,t.jsx)("div",{className:"w-full lg:w-2/3",children:(0,t.jsxs)("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:h?"Editando: ".concat(h.step_key):"Selecione um prompt para editar"})}),h?u?(0,t.jsx)("div",{className:"text-center py-16",children:(0,t.jsx)("p",{className:"text-gray-500",children:"Carregando conte\xfado do prompt..."})}):(0,t.jsxs)("div",{className:"p-6",children:[E&&(0,t.jsx)("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded",children:"Prompt salvo com sucesso!"}),_&&(0,t.jsx)("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:_}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{htmlFor:"prompt-content",className:"block text-sm font-medium text-gray-700 mb-2",children:"Conte\xfado do Prompt"}),(0,t.jsx)("textarea",{id:"prompt-content",value:b,onChange:e=>f(e.target.value),className:"w-full h-80 border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-primary-500 font-mono text-sm"}),(0,t.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:["Use as vari\xe1veis entre chaves para inserir informa\xe7\xf5es din\xe2micas, ex: ","{patient_name}"]})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("button",{onClick:z,disabled:N,className:"bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-6 rounded-lg",children:N?"Salvando...":"Salvar Altera\xe7\xf5es"})})]}):(0,t.jsx)("div",{className:"text-center py-16",children:(0,t.jsx)("p",{className:"text-gray-500",children:"Selecione um prompt da lista para come\xe7ar a editar"})})]})})]}),(0,t.jsx)("div",{className:"mt-8",children:(0,t.jsx)(c(),{href:"/admin/dashboard",className:"text-primary-600 hover:text-primary-800 font-medium",children:"â† Voltar ao Dashboard"})})]})})}):(0,t.jsx)("div",{className:"flex justify-center items-center h-screen",children:"Carregando..."})}}},e=>{var r=r=>e(e.s=r);e.O(0,[695,636,593,792],()=>r(4316)),_N_E=e.O()}]);